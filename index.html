<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Folha de Etiquetas A4 — Gerador</title>
    <style>
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
      @media print {
        .controls {
          display: none;
        }
        body,
        html {
          width: 297mm;
          height: 210mm;
        }
      }
      html,
      body {
        margin: 0;
        padding: 0;
        font-family: Inter, system-ui, -apple-system, Roboto, "Helvetica Neue",
          Arial, sans-serif;
      }
      .sheet {
        width: 297mm;
        height: 210mm;
        padding: 10mm;
        display: flex;
        align-items: stretch;
        justify-content: center;
        page-break-after: always;
        box-sizing: border-box;
      }
      .labels {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        grid-template-rows: repeat(6, 1fr);
        gap: 6mm;
        width: 100%;
        height: 100%;
      }
      .label {
        width: 300px;
        height: 150px;
        background: #d73708;
        color: #fff;
        font-weight: 800;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        box-sizing: border-box;
        padding: 6mm 3mm;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        border-radius: 4px;
      }
      .code {
        display: inline-flex;
        align-items: center;
        font-size: 75px;
      }
      .controls {
        position: fixed;
        left: 12px;
        top: 12px;
        z-index: 50;
        background: #fff;
        padding: 12px;
        border: 1px solid #ccc;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      }
      .controls label {
        display: block;
        margin-top: 8px;
        font-size: 14px;
        font-weight: 600;
      }
      .controls input {
        padding: 6px;
        width: 100px;
        margin-right: 6px;
        margin-top: 2px;
      }
      .controls button {
        padding: 8px 12px;
        margin-top: 10px;
        margin-right: 6px;
        border-radius: 6px;
        border: 1px solid #ccc;
        background: #f8f8f8;
        cursor: pointer;
      }
      .controls button:hover {
        background: #eee;
      }
    </style>
  </head>
  <body>
    <div class="controls">
      <label>Prefixo numérico</label>
      <input type="text" id="first" value="7" />
      <label>Letras (de → até)</label>
      <input type="text" id="letterStart" value="A" maxlength="1" />
      <input type="text" id="letterEnd" value="E" maxlength="1" />
      <label>Números (de → até)</label>
      <input type="number" id="numStart" value="1" />
      <input type="number" id="numEnd" value="10" />
      <label>Cor do fundo</label>
      <input type="color" id="bgColor" value="#d73708" />
      <label>Cor do texto</label>
      <input type="color" id="textColor" value="#ffffff" />
      <div>
        <button onclick="generate()">Gerar</button>
        <button onclick="window.print()">Imprimir (A4)</button>
        <button onclick="downloadHTML()">Baixar HTML</button>
      </div>
    </div>
    <main id="pages"></main>
    <script>
      function rangeLetters(start, end) {
        const result = [];
        let s = start.toUpperCase().charCodeAt(0);
        let e = end.toUpperCase().charCodeAt(0);
        for (let i = s; i <= e; i++) {
          result.push(String.fromCharCode(i));
        }
        return result;
      }
      function generate() {
        const first = document.getElementById("first").value || "";
        const lStart = document.getElementById("letterStart").value || "A";
        const lEnd = document.getElementById("letterEnd").value || lStart;
        const nStart = parseInt(document.getElementById("numStart").value, 10);
        const nEnd = parseInt(document.getElementById("numEnd").value, 10);
        const bgColor = document.getElementById("bgColor").value;
        const textColor = document.getElementById("textColor").value;
        const letters = rangeLetters(lStart, lEnd);
        const nums = Array.from({ length: nEnd - nStart + 1 }, (_, i) =>
          String(nStart + i).padStart(2, "0")
        );
        const all = [];
        for (const L of letters) {
          for (const N of nums) {
            all.push({ p1: first, p2: L, p3: N });
          }
        }
        const perPage = 20;
        const pages = Math.ceil(all.length / perPage);
        const pagesEl = document.getElementById("pages");
        pagesEl.innerHTML = "";
        for (let p = 0; p < pages; p++) {
          const sheet = document.createElement("section");
          sheet.className = "sheet";
          const container = document.createElement("div");
          container.className = "labels";
          const chunk = all.slice(p * perPage, (p + 1) * perPage);
          for (let i = 0; i < perPage; i++) {
            if (chunk[i]) {
              container.appendChild(createLabel(chunk[i], bgColor, textColor));
            } else {
              const empty = document.createElement("div");
              empty.className = "label";
              empty.style.background = "transparent";
              container.appendChild(empty);
            }
          }
          sheet.appendChild(container);
          pagesEl.appendChild(sheet);
        }
      }
      function createLabel({ p1, p2, p3 }, bgColor, textColor) {
        const label = document.createElement("div");
        label.className = "label";
        label.style.background = bgColor;
        label.style.color = textColor;
        const code = document.createElement("div");
        code.className = "code";
        const piece1 = document.createElement("div");
        piece1.textContent = p1;
        const sep1 = document.createElement("div");
        sep1.textContent = "-";
        const piece2 = document.createElement("div");
        piece2.textContent = p2;
        const sep2 = document.createElement("div");
        sep2.textContent = "-";
        const piece3 = document.createElement("div");
        piece3.textContent = p3;
        code.append(piece1, sep1, piece2, sep2, piece3);
        label.appendChild(code);
        return label;
      }
      function downloadHTML() {
        const doc = "<!doctype html>\n" + document.documentElement.outerHTML;
        const blob = new Blob([doc], { type: "text/html" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "etiquetas.html";
        a.click();
        URL.revokeObjectURL(url);
      }
      generate();
    </script>
  </body>
</html>
